---
import MdiTwitter from "~icons/mdi/linkedin";
import MdiGithub from "~icons/mdi/github";
import PostsList from "../components/PostsList.astro";
import LinkButton from "../components/LinkButton.astro";
import BaseLayout from "../layouts/BaseLayout.astro";
import { getCollection } from "astro:content";
import SeriesList from "../components/SeriesList.astro";
import { WilmarImage } from "../components/WimarImage";
import { TWITTER_HANDLE, GITHUB_HANDLE } from "../consts";

const posts = await getCollection("blog");
const featuredPosts = posts.filter((post) => post.data.featured);
const featuredSeries = (await getCollection("series")).filter((s) => s.data.featured);

// Stats
const totalPosts = posts.filter((post) => !post.data.planned).length;
const totalTags = new Set(posts.flatMap((post) => post.data.tags)).size;
const totalSeries = (await getCollection("series")).length;
---

<BaseLayout title="Home">
  <main class="space-y-10">
    <section id="hero" class="animate-fade-in-scale">
      <div class="flex flex-1 flex-col sm:pr-6">
        <h1>ğŸ‘‹ Hola!</h1>
        <p class="text-2xl mb-4">
          Soy <strong class="text-3xl bg-gradient-to-r from-primary-600 to-accent-500 bg-clip-text text-transparent">Wilmar SepÃºlveda</strong>
        </p>
        <p class="text-lg leading-relaxed">
          <strong class="text-primary-600 dark:text-primary-400">Lead Data Scientist</strong> con mÃ¡s de 6 aÃ±os de experiencia construyendo soluciones de 
          <span class="font-bold text-accent-600 dark:text-accent-400">Machine Learning</span> e 
          <span class="font-bold text-secondary-600 dark:text-secondary-400">Inteligencia Artificial</span> para los sectores 
          <span class="font-semibold">financiero y asegurador</span>.
        </p>
        
        <div class="my-6 p-4 rounded-xl bg-gradient-to-r from-primary-500/10 to-accent-500/10 border border-primary-500/20">
          <p class="text-base leading-relaxed">
            ğŸš€ Actualmente trabajo para <strong class="text-primary-600 dark:text-primary-400">ASSA</strong> (la aseguradora mÃ¡s grande de CentroamÃ©rica) 
            en colaboraciÃ³n con <strong class="text-accent-600 dark:text-accent-400">McKinsey & Company</strong>, 
            desarrollando <span class="font-semibold">Feature Stores</span> y sistemas de <span class="font-semibold">precios dinÃ¡micos</span> con ML.
          </p>
        </div>

        <p class="text-base leading-relaxed">
          De <strong>Colombia ğŸ‡¨ğŸ‡´</strong>, especializado en 
          <span class="font-semibold text-primary-600 dark:text-primary-400">MLOps</span>, 
          <span class="font-semibold text-accent-600 dark:text-accent-400">Data Engineering</span>, e 
          <span class="font-semibold text-secondary-600 dark:text-secondary-400">InvestigaciÃ³n</span>. 
          TambiÃ©n soy <strong>docente en Universidad Libre</strong> ğŸ‘¨â€ğŸ«, donde enseÃ±o Machine Learning y EstadÃ­stica.
        </p>
        
        <div class="social-wrapper">
          <div class="social-links">Conectemos:</div>
          <a href={TWITTER_HANDLE} target="_blank" class="group relative overflow-hidden inline-flex items-center justify-center space-x-2 py-2 px-4 rounded-lg bg-gradient-to-r from-primary-600 to-accent-500 hover:from-primary-700 hover:to-accent-600 text-white shadow-md hover:shadow-xl hover:scale-105 transition-all duration-300">
            <MdiTwitter />
            <span class="font-medium">LinkedIn</span>
          </a>
          <a href={GITHUB_HANDLE} target="_blank" class="group relative overflow-hidden inline-flex items-center justify-center space-x-2 py-2 px-4 rounded-lg bg-gradient-to-r from-secondary-600 to-primary-600 hover:from-secondary-700 hover:to-primary-700 text-white shadow-md hover:shadow-xl hover:scale-105 transition-all duration-300">
            <MdiGithub />
            <span class="font-medium">GitHub</span>
          </a>
        </div>
        <p class="mt-4">
          Conoce mÃ¡s sobre mi trayectoria en la
          <LinkButton
            className="hover:text-skin-accent underline underline-offset-4 decoration-dashed"
            href="/about"
          >
            pÃ¡gina About
          </LinkButton>
        </p>
      </div>
      <WilmarImage />
    </section>

      {featuredPosts.length > 0 && (
        <div class="space-y-5 animate-fade-in delay-200">
          <h1 class="text-3xl text-black dark:text-white">ğŸ“œ Featured Posts</h1>
          <PostsList posts={featuredPosts} />
        </div>
      )}
      {featuredSeries.length > 0 && (
        <div class="space-y-5 animate-fade-in delay-300">
          <h1 class="text-3xl text-black dark:text-white">Featured Series</h1>
          <SeriesList series={featuredSeries} />
        </div>
      )}
    </div>
  </main>
</BaseLayout>


<style>
  /* ===== Hero Section ===== */
  #hero {
    @apply flex sm:flex-row sm:pb-12 sm:pt-12 flex-col items-end pb-12 pt-12;
    background: linear-gradient(135deg, rgba(168, 85, 247, 0.08) 0%, rgba(236, 72, 153, 0.08) 100%);
    border-radius: 1.5rem;
    padding: 2.5rem;
    position: relative;
    overflow: hidden;
  }
  
  #hero::before {
    content: '';
    position: absolute;
    top: -50%;
    right: -10%;
    width: 500px;
    height: 500px;
    background: radial-gradient(circle, rgba(168, 85, 247, 0.15) 0%, transparent 70%);
    animation: float 20s ease-in-out infinite;
  }
  
  #hero::after {
    content: '';
    position: absolute;
    bottom: -30%;
    left: -5%;
    width: 400px;
    height: 400px;
    background: radial-gradient(circle, rgba(236, 72, 153, 0.12) 0%, transparent 70%);
    animation: float 15s ease-in-out infinite reverse;
  }
  
  @keyframes float {
    0%, 100% {
      transform: translate(0, 0) scale(1);
    }
    50% {
      transform: translate(30px, -30px) scale(1.1);
    }
  }
  
  #hero > * {
    position: relative;
    z-index: 1;
  }
  
  #hero h1 {
    @apply my-4 inline-block text-3xl font-bold sm:my-8 sm:text-5xl;
  }
  #hero .rss-link {
    @apply mb-6;
  }
  #hero p {
    @apply my-2;
  }
  .social-wrapper {
    @apply mt-4 flex flex-col sm:flex-row sm:items-center;
  }
  .social-links {
    @apply mb-1 mr-2 whitespace-nowrap sm:mb-0;
  } 
</style>